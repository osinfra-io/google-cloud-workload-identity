{{/* Infracost Template: https://www.infracost.io/docs/features/config_file/#template-syntax */}}
# Infracost Configuration
# https://www.infracost.io/docs/config_file

# Do not edit the infracost.yml file directly, it is generated by the infracost.yml.tmpl file.
# Edit the infracost.yml.tmpl file and run the following command from the root of the repository to generate the infracost.yml file:

# infracost generate config --repo-path=. --template-path=infracost.yml.tmpl --out-file=infracost.yml

version: 0.1
projects:
{{- range $match := matchPaths ":location(global|regional)/:type(app|infra)/:app?/tfvars/:env.tfvars" }}
  {{- $appDir := ""}}
  {{- if $match.app }}
    {{- $appDir = print "/" $match.app }}
  {{- end }}
  - path: {{ $match.location }}/{{ $match.type }}{{ $appDir }}
    name: "{{ $match.location }}/{{ $match.type }}{{ $appDir }}: {{ $match.env }}"
    usage_file: {{ $match.location }}/{{ $match.type }}{{ $appDir }}/infracost/{{ $match.env }}.yml
    terraform_var_files:
      - tfvars/{{ $match.env }}.tfvars
{{- end }}
